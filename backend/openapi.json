{"openapi":"3.1.0","info":{"title":"Fineman West API","description":"Fineman West API","version":"0.1.0"},"paths":{"/api/v1/csv-import/upload":{"post":{"tags":["CSV Import"],"summary":"Upload Csv File","description":"Upload and process CSV1 file for invoice aging data import.\n\nThe CSV file should contain the following columns (CSV1 format):\n- Client ID: Unique client identifier\n- Client Name: Account name  \n- Email Address: Contact email address (optional)\n- Invoice #: Unique invoice number\n- Invoice Date: Invoice date (YYYY-MM-DD)\n- Invoice Amount: Original invoice amount (formatted as $XX,XXX.XX)\n- Current (0-30): Amount outstanding 0-30 days\n- 31-60 Days: Amount outstanding 31-60 days\n- 61-90 Days: Amount outstanding 61-90 days\n- 91-120 Days: Amount outstanding 91-120 days\n- 120+ Days: Amount outstanding over 120 days\n- Total Outstanding: Current total outstanding amount\n\nAdditional fields are computed automatically:\n- snapshot_date: Set to current upload date\n- Contact name: Extracted from email or account name\n- phone: Set to null (not provided in CSV1)\n- is_billing_contact: Set to true\n\nReturns:\n    ImportResultSchema with import results and statistics","operationId":"upload_csv_file_api_v1_csv_import_upload_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_csv_file_api_v1_csv_import_upload_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ImportResultSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/csv-import/template":{"get":{"tags":["CSV Import"],"summary":"Download Csv Template","description":"Download a CSV template file with the required column headers.\n\nReturns:\n    CSV template file for download","operationId":"download_csv_template_api_v1_csv_import_template_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v1/email-templates/":{"post":{"tags":["Email Templates"],"summary":"Create Email Template","description":"Create a new email template or new version if identifier exists.\n\nIf a template with the given identifier already exists, this will create\na new version and deactivate the previous version.\n\nArgs:\n    template_data: Template creation data with identifier and content\n    \nReturns:\n    EmailTemplateCreatedResponse: Success message and created template","operationId":"create_email_template_api_v1_email_templates__post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EmailTemplateCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EmailTemplateCreatedResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Email Templates"],"summary":"List Email Templates","description":"List all email templates (latest active versions only) with pagination.\n\nArgs:\n    skip: Number of templates to skip for pagination\n    limit: Maximum number of templates to return\n    \nReturns:\n    EmailTemplateListResponse: Paginated list of latest templates","operationId":"list_email_templates_api_v1_email_templates__get","parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","minimum":0,"description":"Number of templates to skip","default":0,"title":"Skip"},"description":"Number of templates to skip"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":1000,"minimum":1,"description":"Number of templates to return","default":100,"title":"Limit"},"description":"Number of templates to return"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EmailTemplateListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/email-templates/latest":{"get":{"tags":["Email Templates"],"summary":"Get Latest Templates Summary","description":"Get the latest version for each email template identifier in summary format.\n\nReturns a simplified list with just the identifier and template data for each\nactive email template. This is useful for populating dropdowns or getting\na quick overview of all available templates.\n\nReturns:\n    List[EmailTemplateSummary]: List of template summaries with identifier and data","operationId":"get_latest_templates_summary_api_v1_email_templates_latest_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/EmailTemplateSummary"},"type":"array","title":"Response Get Latest Templates Summary Api V1 Email Templates Latest Get"}}}}}}},"/api/v1/email-templates/{identifier}":{"get":{"tags":["Email Templates"],"summary":"Get Email Template","description":"Get the latest active version of an email template by identifier.\n\nArgs:\n    identifier: Template identifier (e.g., ESCALATION, WELCOME)\n    \nReturns:\n    EmailTemplateResponse: Latest active template version","operationId":"get_email_template_api_v1_email_templates__identifier__get","parameters":[{"name":"identifier","in":"path","required":true,"schema":{"type":"string","title":"Identifier"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EmailTemplateResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Email Templates"],"summary":"Update Email Template","description":"Update an email template by creating a new version.\n\nThis creates a new version of the template and deactivates the previous version.\nThe original versions are preserved for audit and rollback purposes.\n\nArgs:\n    identifier: Template identifier\n    update_data: Updated template data\n    \nReturns:\n    EmailTemplateUpdatedResponse: Success message and new template version","operationId":"update_email_template_api_v1_email_templates__identifier__put","parameters":[{"name":"identifier","in":"path","required":true,"schema":{"type":"string","title":"Identifier"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EmailTemplateUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EmailTemplateUpdatedResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Email Templates"],"summary":"Delete Email Template","description":"Delete all versions of an email template.\n\nThis permanently removes all versions of the specified template.\nUse with caution as this action cannot be undone.\n\nArgs:\n    identifier: Template identifier\n    \nReturns:\n    EmailTemplateDeletedResponse: Success message and deletion details","operationId":"delete_email_template_api_v1_email_templates__identifier__delete","parameters":[{"name":"identifier","in":"path","required":true,"schema":{"type":"string","title":"Identifier"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EmailTemplateDeletedResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/email-templates/{identifier}/versions":{"get":{"tags":["Email Templates"],"summary":"Get Template Versions","description":"Get all versions of an email template by identifier.\n\nArgs:\n    identifier: Template identifier\n    \nReturns:\n    EmailTemplateVersionListResponse: List of all template versions","operationId":"get_template_versions_api_v1_email_templates__identifier__versions_get","parameters":[{"name":"identifier","in":"path","required":true,"schema":{"type":"string","title":"Identifier"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EmailTemplateVersionListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/email-templates/{identifier}/versions/{version}":{"get":{"tags":["Email Templates"],"summary":"Get Template Version","description":"Get a specific version of an email template.\n\nArgs:\n    identifier: Template identifier\n    version: Version number\n    \nReturns:\n    EmailTemplateResponse: Specific template version","operationId":"get_template_version_api_v1_email_templates__identifier__versions__version__get","parameters":[{"name":"identifier","in":"path","required":true,"schema":{"type":"string","title":"Identifier"}},{"name":"version","in":"path","required":true,"schema":{"type":"integer","title":"Version"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EmailTemplateResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/email-templates/{identifier}/versions/{version}/activate":{"post":{"tags":["Email Templates"],"summary":"Activate Template Version","description":"Activate a specific version of an email template.\n\nThis makes the specified version the active template and deactivates\nall other versions of the same template.\n\nArgs:\n    identifier: Template identifier\n    version: Version number to activate\n    \nReturns:\n    EmailTemplateActivatedResponse: Success message and activated template","operationId":"activate_template_version_api_v1_email_templates__identifier__versions__version__activate_post","parameters":[{"name":"identifier","in":"path","required":true,"schema":{"type":"string","title":"Identifier"}},{"name":"version","in":"path","required":true,"schema":{"type":"integer","title":"Version"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EmailTemplateActivatedResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/escalation/process":{"post":{"tags":["AI Escalation"],"summary":"Process escalation batch with email sending","description":"Generate and send personalized escalation emails for a batch of contact-ready clients","operationId":"process_escalation_batch_api_v1_escalation_process_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EscalationRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EscalationBatchResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/escalation/preview":{"post":{"tags":["AI Escalation"],"summary":"Preview escalation emails","description":"Generate escalation email previews without processing or sending","operationId":"preview_escalation_emails_api_v1_escalation_preview_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EscalationPreviewRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EscalationPreviewResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/escalation/analyze":{"post":{"tags":["AI Escalation"],"summary":"Analyze escalation requirements","description":"Analyze contact data to understand escalation requirements without generating emails","operationId":"analyze_escalation_requirements_api_v1_escalation_analyze_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EscalationStatsRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EscalationAnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/escalation/templates":{"get":{"tags":["AI Escalation"],"summary":"List escalation templates","description":"Get information about available escalation email templates","operationId":"list_escalation_templates_api_v1_escalation_templates_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EscalationTemplateListResponse"}}}}}}},"/api/v1/escalation/validate":{"post":{"tags":["AI Escalation"],"summary":"Validate escalation input","description":"Validate contact data before processing escalations","operationId":"validate_escalation_input_api_v1_escalation_validate_post","requestBody":{"content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/ContactReadyClient-Input"},"type":"array","title":"Contacts"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EscalationValidationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/escalation/ai/status":{"get":{"tags":["AI Escalation"],"summary":"Check AI service status","description":"Check the status and availability of the Claude AI service","operationId":"check_ai_service_status_api_v1_escalation_ai_status_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Check Ai Service Status Api V1 Escalation Ai Status Get"}}}}}}},"/api/v1/escalation/degrees/info":{"get":{"tags":["AI Escalation"],"summary":"Get escalation degree information","description":"Get information about escalation degree calculation rules","operationId":"get_escalation_degree_info_api_v1_escalation_degrees_info_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Get Escalation Degree Info Api V1 Escalation Degrees Info Get"}}}}}}},"/health":{"get":{"summary":"Health Check","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"AgingSnapshotSummary-Input":{"properties":{"invoice_number":{"type":"string","title":"Invoice Number","description":"Invoice number"},"invoice_date":{"type":"string","format":"date","title":"Invoice Date","description":"Date the invoice was issued"},"snapshot_date":{"type":"string","format":"date","title":"Snapshot Date","description":"Date of the aging snapshot"},"days_0_30":{"anyOf":[{"type":"number","minimum":0.0},{"type":"string"}],"title":"Days 0 30","description":"Amount outstanding 0-30 days"},"days_31_60":{"anyOf":[{"type":"number","minimum":0.0},{"type":"string"}],"title":"Days 31 60","description":"Amount outstanding 31-60 days"},"days_61_90":{"anyOf":[{"type":"number","minimum":0.0},{"type":"string"}],"title":"Days 61 90","description":"Amount outstanding 61-90 days"},"days_91_120":{"anyOf":[{"type":"number","minimum":0.0},{"type":"string"}],"title":"Days 91 120","description":"Amount outstanding 91-120 days"},"days_over_120":{"anyOf":[{"type":"number","minimum":0.0},{"type":"string"}],"title":"Days Over 120","description":"Amount outstanding over 120 days"}},"type":"object","required":["invoice_number","invoice_date","snapshot_date","days_0_30","days_31_60","days_61_90","days_91_120","days_over_120"],"title":"AgingSnapshotSummary","description":"Schema for aging snapshot summary in contact ready clients."},"AgingSnapshotSummary-Output":{"properties":{"invoice_number":{"type":"string","title":"Invoice Number","description":"Invoice number"},"invoice_date":{"type":"string","format":"date","title":"Invoice Date","description":"Date the invoice was issued"},"snapshot_date":{"type":"string","format":"date","title":"Snapshot Date","description":"Date of the aging snapshot"},"days_0_30":{"type":"string","title":"Days 0 30","description":"Amount outstanding 0-30 days"},"days_31_60":{"type":"string","title":"Days 31 60","description":"Amount outstanding 31-60 days"},"days_61_90":{"type":"string","title":"Days 61 90","description":"Amount outstanding 61-90 days"},"days_91_120":{"type":"string","title":"Days 91 120","description":"Amount outstanding 91-120 days"},"days_over_120":{"type":"string","title":"Days Over 120","description":"Amount outstanding over 120 days"}},"type":"object","required":["invoice_number","invoice_date","snapshot_date","days_0_30","days_31_60","days_61_90","days_91_120","days_over_120"],"title":"AgingSnapshotSummary","description":"Schema for aging snapshot summary in contact ready clients."},"AgingSummary":{"properties":{"days_0_30":{"type":"string","title":"Days 0 30","description":"Amount in 0-30 days","default":"0"},"days_31_60":{"type":"string","title":"Days 31 60","description":"Amount in 31-60 days","default":"0"},"days_61_90":{"type":"string","title":"Days 61 90","description":"Amount in 61-90 days","default":"0"},"days_91_120":{"type":"string","title":"Days 91 120","description":"Amount in 91-120 days","default":"0"},"days_over_120":{"type":"string","title":"Days Over 120","description":"Amount over 120 days","default":"0"},"total":{"type":"string","title":"Total","description":"Total outstanding amount","default":"0"}},"type":"object","title":"AgingSummary","description":"Summary of aging buckets across all invoices."},"Body_upload_csv_file_api_v1_csv_import_upload_post":{"properties":{"file":{"type":"string","format":"binary","title":"File","description":"CSV file to import"}},"type":"object","required":["file"],"title":"Body_upload_csv_file_api_v1_csv_import_upload_post"},"ContactReadyClient-Input":{"properties":{"client_id":{"type":"string","title":"Client Id","description":"Unique client identifier from CSV"},"account_name":{"type":"string","title":"Account Name","description":"Account name"},"email_address":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Email Address","description":"Contact email address"},"invoice_aging_snapshots":{"items":{"$ref":"#/components/schemas/AgingSnapshotSummary-Input"},"type":"array","title":"Invoice Aging Snapshots","description":"List of aging snapshots created"},"total_outstanding_across_invoices":{"anyOf":[{"type":"number","minimum":0.0},{"type":"string"}],"title":"Total Outstanding Across Invoices","description":"Sum of total outstanding across all invoices"},"dnc_status":{"type":"boolean","title":"Dnc Status","description":"Do not contact status based on email and aging bucket distribution"}},"type":"object","required":["client_id","account_name","invoice_aging_snapshots","total_outstanding_across_invoices","dnc_status"],"title":"ContactReadyClient","description":"Schema for contact ready client information."},"ContactReadyClient-Output":{"properties":{"client_id":{"type":"string","title":"Client Id","description":"Unique client identifier from CSV"},"account_name":{"type":"string","title":"Account Name","description":"Account name"},"email_address":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Email Address","description":"Contact email address"},"invoice_aging_snapshots":{"items":{"$ref":"#/components/schemas/AgingSnapshotSummary-Output"},"type":"array","title":"Invoice Aging Snapshots","description":"List of aging snapshots created"},"total_outstanding_across_invoices":{"type":"string","title":"Total Outstanding Across Invoices","description":"Sum of total outstanding across all invoices"},"dnc_status":{"type":"boolean","title":"Dnc Status","description":"Do not contact status based on email and aging bucket distribution"}},"type":"object","required":["client_id","account_name","invoice_aging_snapshots","total_outstanding_across_invoices","dnc_status"],"title":"ContactReadyClient","description":"Schema for contact ready client information."},"EmailSendingDetail":{"properties":{"account_id":{"type":"string","title":"Account Id","description":"Account ID"},"account_name":{"type":"string","title":"Account Name","description":"Account name"},"email_address":{"type":"string","title":"Email Address","description":"Email address"},"email_sent":{"type":"boolean","title":"Email Sent","description":"Whether email was sent successfully"},"email_sent_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Email Sent At","description":"When email was sent"},"email_message_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Email Message Id","description":"SMTP message ID"},"email_subject":{"type":"string","title":"Email Subject","description":"Email subject"},"email_send_error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Email Send Error","description":"Error message if sending failed"},"escalation_degree":{"type":"integer","maximum":3.0,"minimum":1.0,"title":"Escalation Degree","description":"Escalation degree (1-3)"},"template_used":{"type":"string","title":"Template Used","description":"Email template identifier"},"invoice_count":{"type":"integer","title":"Invoice Count","description":"Number of overdue invoices"},"total_outstanding":{"type":"string","title":"Total Outstanding","description":"Total outstanding amount"},"oldest_invoice_days":{"type":"integer","title":"Oldest Invoice Days","description":"Days overdue for oldest invoice"},"invoices":{"items":{"$ref":"#/components/schemas/InvoiceDetail"},"type":"array","title":"Invoices","description":"List of invoice details"},"aging_summary":{"$ref":"#/components/schemas/AgingSummary","description":"Summary of aging buckets"}},"type":"object","required":["account_id","account_name","email_address","email_sent","email_subject","escalation_degree","template_used","invoice_count","total_outstanding","oldest_invoice_days","invoices","aging_summary"],"title":"EmailSendingDetail","description":"Detailed information about a sent escalation email."},"EmailSendingSummary":{"properties":{"total_attempts":{"type":"integer","title":"Total Attempts","description":"Total number of email send attempts"},"successful_sends":{"type":"integer","title":"Successful Sends","description":"Number of successfully sent emails"},"failed_sends":{"type":"integer","title":"Failed Sends","description":"Number of failed email sends"},"retry_attempts":{"type":"integer","title":"Retry Attempts","description":"Number of retry attempts made"},"send_duration_seconds":{"type":"number","title":"Send Duration Seconds","description":"Time taken to send all emails"}},"type":"object","required":["total_attempts","successful_sends","failed_sends","retry_attempts","send_duration_seconds"],"title":"EmailSendingSummary","description":"Summary of email sending operations."},"EmailTemplateActivatedResponse":{"properties":{"message":{"type":"string","title":"Message","description":"Success message"},"template":{"$ref":"#/components/schemas/EmailTemplateResponse","description":"Activated template"},"previous_active_version":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Previous Active Version","description":"Previously active version number"}},"type":"object","required":["message","template"],"title":"EmailTemplateActivatedResponse","description":"Schema for successful version activation."},"EmailTemplateCreate":{"properties":{"identifier":{"type":"string","maxLength":100,"minLength":1,"pattern":"^[A-Z_][A-Z0-9_]*$","title":"Identifier","description":"Template identifier (uppercase letters, numbers, underscores only)"},"data":{"$ref":"#/components/schemas/EmailTemplateData","description":"Template data containing subject and body"}},"type":"object","required":["identifier","data"],"title":"EmailTemplateCreate","description":"Schema for creating a new email template."},"EmailTemplateCreatedResponse":{"properties":{"message":{"type":"string","title":"Message","description":"Success message"},"template":{"$ref":"#/components/schemas/EmailTemplateResponse","description":"Created template"}},"type":"object","required":["message","template"],"title":"EmailTemplateCreatedResponse","description":"Schema for successful template creation."},"EmailTemplateData":{"properties":{"subject":{"type":"string","maxLength":500,"minLength":1,"title":"Subject","description":"Email subject line"},"body":{"type":"string","minLength":1,"title":"Body","description":"Email body content in HTML format"}},"type":"object","required":["subject","body"],"title":"EmailTemplateData","description":"Schema for validating JSONB email template data."},"EmailTemplateDeletedResponse":{"properties":{"message":{"type":"string","title":"Message","description":"Success message"},"identifier":{"type":"string","title":"Identifier","description":"Deleted template identifier"},"versions_deleted":{"type":"integer","title":"Versions Deleted","description":"Number of versions deleted"}},"type":"object","required":["message","identifier","versions_deleted"],"title":"EmailTemplateDeletedResponse","description":"Schema for successful template deletion."},"EmailTemplateListResponse":{"properties":{"templates":{"items":{"$ref":"#/components/schemas/EmailTemplateResponse"},"type":"array","title":"Templates","description":"List of templates"},"total":{"type":"integer","title":"Total","description":"Total number of templates"},"page":{"type":"integer","title":"Page","description":"Current page number"},"page_size":{"type":"integer","title":"Page Size","description":"Number of items per page"},"total_pages":{"type":"integer","title":"Total Pages","description":"Total number of pages"}},"type":"object","required":["templates","total","page","page_size","total_pages"],"title":"EmailTemplateListResponse","description":"Schema for paginated list of email templates."},"EmailTemplateResponse":{"properties":{"id":{"type":"string","title":"Id","description":"Template UUID"},"identifier":{"type":"string","title":"Identifier","description":"Template identifier"},"version":{"type":"integer","title":"Version","description":"Template version number"},"data":{"$ref":"#/components/schemas/EmailTemplateData","description":"Template data"},"is_active":{"type":"boolean","title":"Is Active","description":"Whether this is the active version"},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"Creation timestamp"},"updated_at":{"type":"string","format":"date-time","title":"Updated At","description":"Last update timestamp"}},"type":"object","required":["id","identifier","version","data","is_active","created_at","updated_at"],"title":"EmailTemplateResponse","description":"Schema for email template API responses."},"EmailTemplateSummary":{"properties":{"identifier":{"type":"string","title":"Identifier","description":"Template identifier"},"template_data":{"$ref":"#/components/schemas/EmailTemplateData","description":"Template data from JSONB column"}},"type":"object","required":["identifier","template_data"],"title":"EmailTemplateSummary","description":"Schema for template summary (identifier and data only)."},"EmailTemplateUpdate":{"properties":{"data":{"$ref":"#/components/schemas/EmailTemplateData","description":"Updated template data containing subject and body"}},"type":"object","required":["data"],"title":"EmailTemplateUpdate","description":"Schema for updating an email template (creates new version)."},"EmailTemplateUpdatedResponse":{"properties":{"message":{"type":"string","title":"Message","description":"Success message"},"template":{"$ref":"#/components/schemas/EmailTemplateResponse","description":"Updated template"},"previous_version":{"type":"integer","title":"Previous Version","description":"Previous active version number"}},"type":"object","required":["message","template","previous_version"],"title":"EmailTemplateUpdatedResponse","description":"Schema for successful template update."},"EmailTemplateVersionListResponse":{"properties":{"identifier":{"type":"string","title":"Identifier","description":"Template identifier"},"versions":{"items":{"$ref":"#/components/schemas/EmailTemplateVersionResponse"},"type":"array","title":"Versions","description":"List of versions"},"total_versions":{"type":"integer","title":"Total Versions","description":"Total number of versions"}},"type":"object","required":["identifier","versions","total_versions"],"title":"EmailTemplateVersionListResponse","description":"Schema for list of template versions."},"EmailTemplateVersionResponse":{"properties":{"id":{"type":"string","title":"Id","description":"Template UUID"},"version":{"type":"integer","title":"Version","description":"Template version number"},"is_active":{"type":"boolean","title":"Is Active","description":"Whether this is the active version"},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"Creation timestamp"},"updated_at":{"type":"string","format":"date-time","title":"Updated At","description":"Last update timestamp"}},"type":"object","required":["id","version","is_active","created_at","updated_at"],"title":"EmailTemplateVersionResponse","description":"Schema for template version information without full data."},"EscalationAnalysisResponse":{"properties":{"stats":{"$ref":"#/components/schemas/EscalationStats","description":"Escalation statistics"},"degree_breakdown":{"additionalProperties":{"items":{"type":"string"},"type":"array"},"type":"object","title":"Degree Breakdown","description":"Account names by escalation degree"},"recommendations":{"items":{"type":"string"},"type":"array","title":"Recommendations","description":"Processing recommendations"}},"type":"object","required":["stats","degree_breakdown","recommendations"],"title":"EscalationAnalysisResponse","description":"Response for escalation analysis."},"EscalationBatchResponse":{"properties":{"success":{"type":"boolean","title":"Success","description":"Whether the batch processing was successful"},"processed_count":{"type":"integer","title":"Processed Count","description":"Number of accounts processed"},"emails_generated":{"type":"integer","title":"Emails Generated","description":"Number of emails generated"},"skipped_count":{"type":"integer","title":"Skipped Count","description":"Number of accounts skipped"},"escalation_results":{"items":{"$ref":"#/components/schemas/EscalationResult"},"type":"array","title":"Escalation Results","description":"Generated escalation emails"},"skipped_reasons":{"additionalProperties":{"type":"integer"},"type":"object","title":"Skipped Reasons","description":"Reasons for skipping accounts with counts"},"processing_time_seconds":{"type":"number","title":"Processing Time Seconds","description":"Time taken to process the batch"},"errors":{"items":{"type":"string"},"type":"array","title":"Errors","description":"Any errors encountered during processing","default":[]},"email_sending_summary":{"anyOf":[{"$ref":"#/components/schemas/EmailSendingSummary"},{"type":"null"}],"description":"Summary of email sending operations"},"email_sending_details":{"items":{"$ref":"#/components/schemas/EmailSendingDetail"},"type":"array","title":"Email Sending Details","description":"Detailed statistics for each sent email","default":[]}},"type":"object","required":["success","processed_count","emails_generated","skipped_count","escalation_results","skipped_reasons","processing_time_seconds"],"title":"EscalationBatchResponse","description":"Response for batch escalation processing."},"EscalationPreviewRequest":{"properties":{"contact_ready_clients":{"items":{"$ref":"#/components/schemas/ContactReadyClient-Input"},"type":"array","title":"Contact Ready Clients","description":"List of contact ready clients for preview"}},"type":"object","required":["contact_ready_clients"],"title":"EscalationPreviewRequest","description":"Request schema for previewing escalation emails without sending."},"EscalationPreviewResponse":{"properties":{"preview_results":{"items":{"$ref":"#/components/schemas/EscalationResult"},"type":"array","title":"Preview Results","description":"Preview of generated emails"},"summary":{"additionalProperties":true,"type":"object","title":"Summary","description":"Summary of escalation analysis"},"template_usage":{"additionalProperties":{"type":"integer"},"type":"object","title":"Template Usage","description":"Count of templates that would be used"}},"type":"object","required":["preview_results","summary","template_usage"],"title":"EscalationPreviewResponse","description":"Response for escalation preview."},"EscalationRequest":{"properties":{"contact_ready_clients":{"items":{"$ref":"#/components/schemas/ContactReadyClient-Input"},"type":"array","title":"Contact Ready Clients","description":"List of contact ready clients with aging snapshots"},"preview_only":{"type":"boolean","title":"Preview Only","description":"If true, generate emails but don't send them","default":false},"send_emails":{"type":"boolean","title":"Send Emails","description":"Whether to actually send emails (only applies if preview_only=False)","default":true},"email_batch_size":{"type":"integer","maximum":50.0,"minimum":1.0,"title":"Email Batch Size","description":"Number of emails to send concurrently","default":10},"retry_failed_emails":{"type":"boolean","title":"Retry Failed Emails","description":"Whether to retry failed email sends","default":true}},"type":"object","required":["contact_ready_clients"],"title":"EscalationRequest","description":"Request schema for processing escalations."},"EscalationResult":{"properties":{"account":{"type":"string","title":"Account","description":"Account name"},"email_address":{"type":"string","title":"Email Address","description":"Contact email address"},"email_subject":{"type":"string","title":"Email Subject","description":"Email subject line"},"email_body":{"type":"string","title":"Email Body","description":"Personalized HTML email content"},"escalation_degree":{"type":"integer","maximum":3.0,"minimum":1.0,"title":"Escalation Degree","description":"Calculated escalation degree"},"template_used":{"type":"string","title":"Template Used","description":"Email template identifier used"},"invoice_count":{"type":"integer","minimum":1.0,"title":"Invoice Count","description":"Number of overdue invoices"},"total_outstanding":{"type":"string","title":"Total Outstanding","description":"Total outstanding amount"},"email_sent":{"type":"boolean","title":"Email Sent","description":"Whether email was sent successfully","default":false},"email_sent_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Email Sent At","description":"When email was sent"},"email_message_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Email Message Id","description":"SMTP message ID"},"email_send_error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Email Send Error","description":"Error message if sending failed"},"invoice_details":{"items":{"$ref":"#/components/schemas/InvoiceDetail"},"type":"array","title":"Invoice Details","description":"List of invoice details","default":[]},"aging_summary":{"anyOf":[{"$ref":"#/components/schemas/AgingSummary"},{"type":"null"}],"description":"Summary of aging buckets"}},"type":"object","required":["account","email_address","email_subject","email_body","escalation_degree","template_used","invoice_count","total_outstanding"],"title":"EscalationResult","description":"Result of AI-generated escalation email."},"EscalationStats":{"properties":{"total_accounts":{"type":"integer","title":"Total Accounts","description":"Total number of accounts"},"degree_0_count":{"type":"integer","title":"Degree 0 Count","description":"Accounts with degree 0 (no escalation needed)"},"degree_1_count":{"type":"integer","title":"Degree 1 Count","description":"Accounts needing degree 1 escalation"},"degree_2_count":{"type":"integer","title":"Degree 2 Count","description":"Accounts needing degree 2 escalation"},"degree_3_count":{"type":"integer","title":"Degree 3 Count","description":"Accounts needing degree 3 escalation"},"dnc_count":{"type":"integer","title":"Dnc Count","description":"Accounts marked as do not contact"},"no_email_count":{"type":"integer","title":"No Email Count","description":"Accounts without email addresses"},"processable_count":{"type":"integer","title":"Processable Count","description":"Accounts that can be processed for escalation"},"total_outstanding":{"type":"string","title":"Total Outstanding","description":"Total outstanding amount across all accounts"}},"type":"object","required":["total_accounts","degree_0_count","degree_1_count","degree_2_count","degree_3_count","dnc_count","no_email_count","processable_count","total_outstanding"],"title":"EscalationStats","description":"Statistics about escalation degrees in the provided data."},"EscalationStatsRequest":{"properties":{"contact_ready_clients":{"items":{"$ref":"#/components/schemas/ContactReadyClient-Input"},"type":"array","title":"Contact Ready Clients","description":"List of contact ready clients for analysis"}},"type":"object","required":["contact_ready_clients"],"title":"EscalationStatsRequest","description":"Request for escalation statistics."},"EscalationTemplateInfo":{"properties":{"identifier":{"type":"string","title":"Identifier","description":"Template identifier"},"escalation_degree":{"type":"integer","maximum":3.0,"minimum":1.0,"title":"Escalation Degree","description":"Associated escalation degree"},"subject":{"type":"string","title":"Subject","description":"Email subject template"},"variables":{"items":{"type":"string"},"type":"array","title":"Variables","description":"Available template variables"},"description":{"type":"string","title":"Description","description":"Template description"}},"type":"object","required":["identifier","escalation_degree","subject","variables","description"],"title":"EscalationTemplateInfo","description":"Information about available escalation templates."},"EscalationTemplateListResponse":{"properties":{"templates":{"items":{"$ref":"#/components/schemas/EscalationTemplateInfo"},"type":"array","title":"Templates","description":"Available escalation templates"},"total_templates":{"type":"integer","title":"Total Templates","description":"Total number of templates"}},"type":"object","required":["templates","total_templates"],"title":"EscalationTemplateListResponse","description":"Response listing available escalation templates."},"EscalationValidationError":{"properties":{"account_name":{"type":"string","title":"Account Name","description":"Account that failed validation"},"field":{"type":"string","title":"Field","description":"Field that failed validation"},"error_message":{"type":"string","title":"Error Message","description":"Validation error message"}},"type":"object","required":["account_name","field","error_message"],"title":"EscalationValidationError","description":"Validation error details."},"EscalationValidationResponse":{"properties":{"is_valid":{"type":"boolean","title":"Is Valid","description":"Whether all inputs are valid"},"validation_errors":{"items":{"$ref":"#/components/schemas/EscalationValidationError"},"type":"array","title":"Validation Errors","description":"List of validation errors","default":[]},"valid_accounts":{"type":"integer","title":"Valid Accounts","description":"Number of accounts that passed validation"},"invalid_accounts":{"type":"integer","title":"Invalid Accounts","description":"Number of accounts that failed validation"}},"type":"object","required":["is_valid","valid_accounts","invalid_accounts"],"title":"EscalationValidationResponse","description":"Response for escalation input validation."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"ImportErrorSchema":{"properties":{"row_number":{"type":"integer","title":"Row Number","description":"Row number where error occurred"},"field":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Field","description":"Field that caused the error"},"error_message":{"type":"string","title":"Error Message","description":"Error description"},"row_data":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Row Data","description":"Raw row data that caused error"}},"type":"object","required":["row_number","error_message"],"title":"ImportErrorSchema","description":"Schema for import errors."},"ImportResultSchema":{"properties":{"success":{"type":"boolean","title":"Success","description":"Whether import was successful"},"total_rows":{"type":"integer","title":"Total Rows","description":"Total number of rows processed"},"successful_rows":{"type":"integer","title":"Successful Rows","description":"Number of successfully imported rows"},"failed_rows":{"type":"integer","title":"Failed Rows","description":"Number of failed rows"},"accounts_created":{"type":"integer","title":"Accounts Created","description":"Number of new accounts created","default":0},"contacts_created":{"type":"integer","title":"Contacts Created","description":"Number of new contacts created","default":0},"invoices_created":{"type":"integer","title":"Invoices Created","description":"Number of new invoices created","default":0},"invoices_updated":{"type":"integer","title":"Invoices Updated","description":"Number of existing invoices updated","default":0},"aging_snapshots_created":{"type":"integer","title":"Aging Snapshots Created","description":"Number of aging snapshots created","default":0},"contact_ready_clients":{"items":{"$ref":"#/components/schemas/ContactReadyClient-Output"},"type":"array","title":"Contact Ready Clients","description":"List of clients with aging snapshots created","default":[]},"errors":{"items":{"$ref":"#/components/schemas/ImportErrorSchema"},"type":"array","title":"Errors","description":"List of errors encountered","default":[]},"processing_time_seconds":{"type":"number","title":"Processing Time Seconds","description":"Time taken to process import"}},"type":"object","required":["success","total_rows","successful_rows","failed_rows","processing_time_seconds"],"title":"ImportResultSchema","description":"Schema for CSV import results."},"InvoiceDetail":{"properties":{"invoice_id":{"type":"string","title":"Invoice Id","description":"Invoice ID"},"invoice_number":{"type":"string","title":"Invoice Number","description":"Invoice number"},"invoice_amount":{"type":"string","title":"Invoice Amount","description":"Original invoice amount"},"total_outstanding":{"type":"string","title":"Total Outstanding","description":"Current outstanding amount"},"days_overdue":{"type":"integer","title":"Days Overdue","description":"Number of days overdue"},"aging_bucket":{"type":"string","title":"Aging Bucket","description":"Aging bucket (31-60, 61-90, 91-120, 120+)"}},"type":"object","required":["invoice_id","invoice_number","invoice_amount","total_outstanding","days_overdue","aging_bucket"],"title":"InvoiceDetail","description":"Details about an individual invoice for email statistics."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}